- name: "wait 600 seconds for target connection to become reachable/usable."
  ansible.builtin.wait_for_connection:
  timeout: 900
- name: Copy file with owner and permissions
  copy:
    src: ./dist
    dest: /
    owner: udacity
    group: udacity
    mode: '0644'
  environment:
    ENVIRONMENT: "production"
    TYPEORM_CONNECTION: "postgres"
    TYPEORM_ENTITIES: "./dist/modules/domain/*/*/*.entity.js"
    TYPEORM_HOST: "{{ lookup ('env', 'TYPEORM_HOST') }}"
    TYPEORM_PORT: "{{ lookup ('env', 'TYPEORM_PORT') }}"
    TYPEORM_USERNAME: "{{ lookup ('env', 'TYPEORM_USERNAME') }}"
    TYPEORM_PASSWORD: "{{ lookup ('env', 'TYPEORM_PASSWORD') }}"
    TYPEORM_DATABASE: "{{ lookup ('env', 'TYPEORM_DATABASE') }}"